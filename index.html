<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Ultimate Genially Player Configurator</title>
    <style>
        :root { --accent: #ff0055; --bg: #0b0b0d; --panel: #16161a; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 400px; background: var(--panel); padding: 25px; border-right: 1px solid #2d2d33; overflow-y: auto; display: flex; flex-direction: column; }
        h1 { font-size: 1.1rem; color: #00d4ff; text-transform: uppercase; letter-spacing: 2px; margin: 0 0 20px 0; border-bottom: 1px solid #333; padding-bottom: 10px; }
        label { display: block; font-size: 0.7rem; color: #888; margin: 15px 0 5px; text-transform: uppercase; font-weight: bold; }
        input, select, textarea { width: 100%; background: #222; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        .btn-gen { background: var(--accent); color: #fff; border: none; padding: 18px; border-radius: 12px; cursor: pointer; font-weight: bold; width: 100%; transition: 0.3s; margin-top: 20px; font-size: 16px; }
        .btn-gen:hover { transform: translateY(-2px); box-shadow: 0 5px 20px var(--accent); }
        .main { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle, #1a1a1a, #000); }
        #modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 700px; background: #111; padding: 30px; border-radius: 20px; border: 1px solid #333; display: none; z-index: 1000; box-shadow: 0 0 100px #000; }
        #codeOut { width: 100%; height: 250px; background: #000; color: #0f9; font-family: monospace; font-size: 11px; padding: 15px; border: 1px solid #222; margin-top: 15px; border-radius: 10px; word-break: break-all; }
        .overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); display:none; z-index: 999; }
    </style>
</head>
<body>

<div class="sidebar">
    <h1>Configurator</h1>
    <label>GitHub Root</label>
    <input type="text" id="ghPath" value="https://lindtjulia1-web.github.io/AUDIOPLAYER1/">
    <div style="display:flex; gap:10px;">
        <div style="flex:1"><label>Accent 1</label><input type="color" id="clr1" value="#ff0055"></div>
        <div style="flex:1"><label>Accent 2</label><input type="color" id="clr2" value="#00d4ff"></div>
    </div>
    <label>Язык</label>
    <select id="lang">
        <option value="ru">Русский</option>
        <option value="de">Deutsch</option>
        <option value="en">English</option>
    </select>
    <label>Playlist (Название | файл)</label>
    <textarea id="tracks" rows="8">Track 01 | 1.mp3
Track 02 | 2.mp3
Track 03 | 3.mp3</textarea>
    <button class="btn-gen" onclick="generate()">СГЕНЕРИРОВАТЬ КОД</button>
</div>

<div class="main"><div id="preview"></div></div>

<div class="overlay" id="overlay" onclick="closeAll()"></div>
<div id="modal">
    <h3 style="margin:0; color:var(--accent)">Код для Genially:</h3>
    <textarea id="codeOut" readonly></textarea>
    <button class="btn-gen" style="margin-top:10px;" onclick="closeAll()">ГОТОВО</button>
</div>

<script>
    function generate() {
        const ghBase = `https://raw.githubusercontent.com/lindtjulia1-web/AUDIOPLAYER1/main/`;
        const c1 = document.getElementById('clr1').value;
        const c2 = document.getElementById('clr2').value;
        const lang = document.getElementById('lang').value;
        const tracksArr = document.getElementById('tracks').value.split('\n').filter(l => l.includes('|')).map(l => {
            const p = l.split('|'); return { n: p[0].trim(), f: p[1].trim() };
        });

        const i18n = {
            ru: { l: "СПИСОК", r: "РАНДОМ", v: "ГРОМКОСТЬ", n: "НЕТ ТРЕКА" },
            de: { l: "LISTE", r: "ZUFALL", v: "LAUTSTÄRKE", n: "KEIN TRACK" },
            en: { l: "LIST", r: "SHUFFLE", v: "VOLUME", n: "NO TRACK" }
        }[lang];

        const innerHTML = `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>
:root { --p: ${c1}; --s: ${c2}; }
body { background: transparent; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: sans-serif; }
.pb { width: 480px; height: 280px; background: rgba(20,18,17,0.98); border: 3px solid #333; border-radius: 20px; display: flex; padding: 15px; box-sizing: border-box; position: relative; color: white; }
.lp { width: 150px; border-right: 1px solid #333; display: flex; justify-content: center; align-items: center; }
.vi { width: 120px; height: 120px; border-radius: 50%; background: radial-gradient(circle, #333, #000); border: 4px solid #111; animation: r 4s linear infinite; animation-play-state: paused; position: relative; }
.vi::after { content:''; position:absolute; top:0; left:0; width:100%; height:100%; border-radius:50%; background: conic-gradient(var(--p), var(--s), var(--p)); opacity: 0.3; }
@keyframes r { from {transform: rotate(0deg);} to {transform: rotate(360deg);} }
.rp { flex: 1; padding-left: 15px; display: flex; flex-direction: column; }
.sc { background: #050505; border: 1px solid #222; border-radius: 12px; padding: 10px; flex: 1; display: flex; flex-direction: column; }
.tm { color: var(--s); font-size: 24px; font-weight: bold; font-family: monospace; }
.vz { display: flex; align-items: flex-end; gap: 2px; height: 30px; margin: 5px 0; }
.br { flex: 1; background: var(--s); height: 2px; transition: 0.1s; }
.vol-box { display: flex; align-items: center; gap: 8px; margin-top: 5px; font-size: 9px; color: #777; }
input[type=range] { flex: 1; accent-color: var(--p); cursor: pointer; height: 4px; }
.controls { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-top: 10px; }
.btn { background: #222; border: 1px solid #333; color: var(--s); padding: 7px; cursor: pointer; border-radius: 6px; font-size: 9px; font-weight: bold; }
.btn.active { color: var(--p); border-color: var(--p); }
#pl { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); display: none; padding: 20px; box-sizing: border-box; z-index: 10; border-radius: 20px; }
</style></head><body>
<div class="pb"><div class="lp"><div class="vi" id="disk"></div></div><div class="rp"><div class="sc">
<div id="title" style="font-size:9px;color:var(--p);text-transform:uppercase;height:12px;overflow:hidden">${i18n.n}</div>
<div class="tm" id="clock">00:00</div>
<div class="vz" id="viz"></div>
<div class="vol-box"><span>${i18n.v}</span><input type="range" min="0" max="1" step="0.01" value="0.7" oninput="audio.volume=this.value"></div>
</div><div class="controls">
<button class="btn" onclick="move(-1)">⏮</button><button class="btn" id="pBtn" onclick="toggle()">▶</button><button class="btn" onclick="move(1)">⏭</button><button class="btn" onclick="showL()">${i18n.l}</button>
<button class="btn" id="sBtn" onclick="shuf()" style="grid-column:span 2">${i18n.r}</button><button class="btn" onclick="location.reload()" style="grid-column:span 2">RESET</button>
</div></div><div id="pl"><div style="display:flex;justify-content:space-between;color:var(--p);font-size:12px;margin-bottom:10px"><b>${i18n.l}</b><span onclick="showL()" style="cursor:pointer">✕</span></div><div id="list" style="overflow-y:auto;height:180px"></div></div></div>
<script>
const B = "${ghBase}", T = ${JSON.stringify(tracksArr)};
let ci=0, iP=false, iS=false; const audio = new Audio();
const disk=document.getElementById('disk'), pBtn=document.getElementById('pBtn'), viz=document.getElementById('viz');
for(let i=0;i<20;i++){ let b=document.createElement('div'); b.className='br'; viz.appendChild(b); }
function load(i){ ci=i; audio.src=T[ci].f.includes('://')?T[ci].f:B+T[ci].f; document.getElementById('title').innerText=T[ci].n; }
function toggle(){ if(iP){ audio.pause(); pBtn.innerText="▶"; disk.style.animationPlayState="paused"; } else { audio.play().then(()=>{ pBtn.innerText="⏸"; disk.style.animationPlayState="running"; }).catch(e=>alert("Файл не найден!")); } iP=!iP; }
function move(s){ if(iS)ci=Math.floor(Math.random()*T.length); else ci=(ci+s+T.length)%T.length; load(ci); if(iP)audio.play(); }
function shuf(){ iS=!iS; document.getElementById('sBtn').classList.toggle('active', iS); }
function showL(){ const w=document.getElementById('pl'); w.style.display=w.style.display==='block'?'none':'block'; document.getElementById('list').innerHTML=T.map((t,i)=>"<div onclick='load("+i+");toggle();showL()' style='padding:8px;border-bottom:1px solid #222;cursor:pointer;font-size:12px;color:"+(i===ci?"var(--p)":"white")+"'>"+t.n+"</div>").join(''); }
audio.ontimeupdate=()=>{ let m=Math.floor(audio.currentTime/60), s=Math.floor(audio.currentTime%60); document.getElementById('clock').innerText=m+":"+(s<10?'0':'')+s; if(iP)document.querySelectorAll('.br').forEach(b=>b.style.height=(Math.random()*25+2)+"px"); };
audio.onended=()=>move(1); audio.volume=0.7; load(0);
<\/script></body></html>`;

        const base64 = btoa(unescape(encodeURIComponent(innerHTML)));
        const finalIframe = `<iframe width="500" height="320" src="data:text/html;base64,${base64}" frameborder="0" scrolling="no" style="background:transparent;"></iframe>`;

        document.getElementById('codeOut').value = finalIframe;
        document.getElementById('preview').innerHTML = finalIframe;
        document.getElementById('modal').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }
    function closeAll() { document.getElementById('modal').style.display = 'none'; document.getElementById('overlay').style.display = 'none'; }
</script>
</body>
</html>
